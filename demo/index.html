<!doctype html>

<head>
    <meta charset="utf-8" />
    <title>Graffiti</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
</head>

<body>
    <h1>Graffiti Login</h1>
    <button id="toggle-login-button"></button>
    <span id="display-actor"></span>

    <script type="module">
        import { GraffitiSolidSessionManagerBrowser } from "../dist/index.js";
        let session = undefined;
        window.sessionManager = new GraffitiSolidSessionManagerBrowser();

        function onLogout() {
            const button = document.querySelector("#toggle-login-button");
            button.onclick = () => sessionManager.login();
            button.innerText = "Login";
            const span = document.querySelector("#display-actor");
            span.innerText = "";
        }

        function onLogin(event) {
            if (event.detail.error) {
                console.error("Error logging in:", event.detail.error);
            } else {
                session = event.detail.session;
            }
            const button = document.querySelector("#toggle-login-button");
            button.innerText = "Logout";
            button.onclick = () => sessionManager.logout(session);
            const span = document.querySelector("#display-actor");
            span.innerText = "Your Actor ID is: " + session.actor;
        }

        sessionManager.sessionEvents.addEventListener("login", onLogin);
        sessionManager.sessionEvents.addEventListener("logout", onLogout);
        onLogout();
    </script>
</body>
